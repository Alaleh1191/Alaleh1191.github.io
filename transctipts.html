<!DOCTYPE html>
<html>
	<head>
		<style>

		.overlay {
		  fill: none;
		  pointer-events: all;
		}

		.axis path, .axis line {
    fill: none;
    stroke: none;
    shape-rendering: crispEdges;
}
		</style>

	</head>
	<body>

		<script src="//d3js.org/d3.v3.min.js"></script>
		<script type="text/javascript">
			var width = 960,
	   			height = 500;

	   		

			var genes = 
			[
				["1", 8378144, 8404227, 
					[8378144,8384365,8385357,8385877,8390268,8395496,8397875,8399552,8403806], [8378246,8384786,8385450,8386102,8390996,8395650,8398052,8399758,8404227]
					], 

				["1", 16767166, 16786584, 
					[16767166,16770126,16774364,16774554,16775587,16778332,16785336], [16767348,16770227,16774469,16774636,16775696,16778510,16786584]
					],

				["1", 16767166, 16786584, [16767166,16770126,16774364,16774554,16775587,16778332,16782312,16785336], [16767270,16770227,16774469,16774636,16775696,16778510,16782388,16786584]],
				["1", 16767166, 16786584, [16767166,16770126,16774364,16774554,16775587,16778332,16782312,16785336], [16767348,16770227,16774469,16774636,16775696,16778510,16782388,16786584]],
				["1", 25071759, 25170815, [25071759,25124232,25140584,25153500,25166350,25167263], [25072116,25124342,25140710,25153607,25166532,25170815]]
			];



			var range = genes[4][2] - genes[0][1];//set to where the min start pos of gene and max end pos of gene transcript
			var start = genes[0][1];
			var xScale = d3.scale.linear()
                         .domain([genes[0][1],genes[4][2]])
                         .range([0,800]);


             

			 var zoom = d3.behavior.zoom()
			    .x(xScale)
			    //.y(y)
			    //.scaleExtent([1, 50])
			    .on("zoom", zoomed);


			var svg = d3.select("body").append("svg")
			    .attr("width", width)
			    .attr("height", height)
			  	.append("g")
			    //.call(d3.behavior.zoom().scaleExtent([1, 8]).on("zoom", zoom))
			    .call(zoom)
			  	.append("g");

			var xAxis = d3.svg.axis()
			    .scale(xScale)
			    .orient("bottom")
			    .tickSize(-height);

			    svg.append("g")
			    .attr("class", "x axis")
			    .attr("transform", "translate(0," + height + ")")
			    .call(xAxis);


		     svg.append("rect")
			    .attr("class", "overlay")
			    .attr("width", width)
			    .attr("height", height)

			for(var i = 0; i < genes.length; i++){

				//console.log(xScale(genes[i][1]), range, start);
				svg.append("line")
                    .attr("x1", xScale(genes[i][1]))
                    .attr("y1", 12+i*10)
                    .attr("x2", xScale(genes[i][2]))
                    .attr("y2", 12+i*10)
                    .attr("stroke-width", 1)
					.attr("stroke", "#3498db");

				for(var j = 0; j<genes[i][3].length; j++){
					svg.append("rect")
                    .attr("x", xScale(genes[i][3][j]))
                    .attr("y", 9+i*10)
                    .attr("width", xScale(genes[i][4][j]) - xScale(genes[i][3][j]))
                    .attr("height", 6)
                    .style("fill", "red");
                }	
                var end = d3.max(genes[i][4])

				var start = d3.min(genes[i][3])

                svg.append("rect")
                    .attr("x", xScale(end))
                    .attr("y", 11+i*10)
                    .attr("width", xScale(genes[i][2]) - xScale(end))
                    .attr("height", 2)
                    .style("fill", "green");

                svg.append("rect")
                    .attr("x", xScale(genes[i][1]))
                    .attr("y", 11+i*10)
                    .attr("width", xScale(start) - xScale(genes[i][1]))
                    .attr("height", 2)
                    .style("fill", "green");


				
			}


			//function zoom() {
			  //svg.attr("transform", "translate(" + d3.event.translate + ")scale(" + d3.event.scale + ")");
			//}
			
function zoomed() {
			  //svg.select(".x.axis").call(xAxis);
			  console.log(d3.event.translate);
			  translate = [d3.event.translate[0], 0];
			  //console.log(translate)
			 // scale = [d3.event.scale[0],1];
			  svg.attr("transform", "translate(" + translate + ")scale(" + d3.event.scale + ", 1)");
			 // svg.select(".y.axis").call(yAxis);
			}

			


		</script>
	</body>
</html>